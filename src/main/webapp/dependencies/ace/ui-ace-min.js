"use strict";angular.module("ui.ace",[]).constant("uiAceConfig",{}).directive("uiAce",["uiAceConfig",function(b){if(angular.isUndefined(window.ace)){throw new Error("ui-ace need ace to work... (o rly?)")}var a=function(f,h,e){if(angular.isDefined(e.workerPath)){var c=window.ace.require("ace/config");c.set("workerPath",e.workerPath)}if(angular.isDefined(e.require)){e.require.forEach(function(i){window.ace.require(i)})}if(angular.isDefined(e.showGutter)){f.renderer.setShowGutter(e.showGutter)}if(angular.isDefined(e.useWrapMode)){h.setUseWrapMode(e.useWrapMode)}if(angular.isDefined(e.showInvisibles)){f.renderer.setShowInvisibles(e.showInvisibles)}if(angular.isDefined(e.showIndentGuides)){f.renderer.setDisplayIndentGuides(e.showIndentGuides)}if(angular.isDefined(e.useSoftTabs)){h.setUseSoftTabs(e.useSoftTabs)}if(angular.isDefined(e.showPrintMargin)){f.setShowPrintMargin(e.showPrintMargin)}if(angular.isDefined(e.disableSearch)&&e.disableSearch){f.commands.addCommands([{name:"unfind",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){return false},readOnly:true}])}if(angular.isString(e.theme)){f.setTheme("ace/theme/"+e.theme)}if(angular.isString(e.mode)){h.setMode("ace/mode/"+e.mode)}if(angular.isDefined(e.firstLineNumber)){if(angular.isNumber(e.firstLineNumber)){h.setOption("firstLineNumber",e.firstLineNumber)}else{if(angular.isFunction(e.firstLineNumber)){h.setOption("firstLineNumber",e.firstLineNumber())}}}var d,g;if(angular.isDefined(e.advanced)){for(d in e.advanced){g={name:d,value:e.advanced[d]};f.setOption(g.name,g.value)}}if(angular.isDefined(e.rendererOptions)){for(d in e.rendererOptions){g={name:d,value:e.rendererOptions[d]};f.renderer.setOption(g.name,g.value)}}angular.forEach(e.callbacks,function(i){if(angular.isFunction(i)){i(f)}})};return{restrict:"EA",require:"?ngModel",link:function(n,i,l,h){var o=b.ace||{};var c=angular.extend({},o,n.$eval(l.uiAce));var k=window.ace.edit(i[0]);var j=k.getSession();var f;var g;var d=function(){var q=arguments[0];var p=Array.prototype.slice.call(arguments,1);if(angular.isDefined(q)){n.$evalAsync(function(){if(angular.isFunction(q)){q(p)}else{throw new Error("ui-ace use a function as callback.")}})}};var m={onChange:function(p){return function(r){var q=j.getValue();if(h&&q!==h.$viewValue&&!n.$$phase&&!n.$root.$$phase){n.$evalAsync(function(){h.$setViewValue(q)})}d(p,r,k)}},onBlur:function(p){return function(){d(p,k)}}};l.$observe("readonly",function(p){k.setReadOnly(!!p||p==="")});if(h){h.$formatters.push(function(p){if(angular.isUndefined(p)||p===null){return""}else{if(angular.isObject(p)||angular.isArray(p)){throw new Error("ui-ace cannot use an object or an array as a model")}}return p});h.$render=function(){j.setValue(h.$viewValue)}}var e=function(q,p){if(q===p){return}c=angular.extend({},o,n.$eval(l.uiAce));c.callbacks=[c.onLoad];if(c.onLoad!==o.onLoad){c.callbacks.unshift(o.onLoad)}j.removeListener("change",f);f=m.onChange(c.onChange);j.on("change",f);k.removeListener("blur",g);g=m.onBlur(c.onBlur);k.on("blur",g);a(k,j,c)};n.$watch(l.uiAce,e,true);e(o);i.on("$destroy",function(){k.session.$stopWorker();k.destroy()});n.$watch(function(){return[i[0].offsetWidth,i[0].offsetHeight]},function(){k.resize();k.renderer.updateFull()},true)}}}]);