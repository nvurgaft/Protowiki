"use strict";angular.module("ui.ace",[]).constant("uiAceConfig",{}).directive("uiAce",["uiAceConfig",function(c){if(angular.isUndefined(window.ace)){throw new Error("ui-ace need ace to work... (o rly?)")}var d=function(i,a,j){if(angular.isDefined(j.workerPath)){var l=window.ace.require("ace/config");l.set("workerPath",j.workerPath)}if(angular.isDefined(j.require)){j.require.forEach(function(e){window.ace.require(e)})}if(angular.isDefined(j.showGutter)){i.renderer.setShowGutter(j.showGutter)}if(angular.isDefined(j.useWrapMode)){a.setUseWrapMode(j.useWrapMode)}if(angular.isDefined(j.showInvisibles)){i.renderer.setShowInvisibles(j.showInvisibles)}if(angular.isDefined(j.showIndentGuides)){i.renderer.setDisplayIndentGuides(j.showIndentGuides)}if(angular.isDefined(j.useSoftTabs)){a.setUseSoftTabs(j.useSoftTabs)}if(angular.isDefined(j.showPrintMargin)){i.setShowPrintMargin(j.showPrintMargin)}if(angular.isDefined(j.disableSearch)&&j.disableSearch){i.commands.addCommands([{name:"unfind",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){return false},readOnly:true}])}if(angular.isString(j.theme)){i.setTheme("ace/theme/"+j.theme)}if(angular.isString(j.mode)){a.setMode("ace/mode/"+j.mode)}if(angular.isDefined(j.firstLineNumber)){if(angular.isNumber(j.firstLineNumber)){a.setOption("firstLineNumber",j.firstLineNumber)}else{if(angular.isFunction(j.firstLineNumber)){a.setOption("firstLineNumber",j.firstLineNumber())}}}var k,b;if(angular.isDefined(j.advanced)){for(k in j.advanced){b={name:k,value:j.advanced[k]};i.setOption(b.name,b.value)}}if(angular.isDefined(j.rendererOptions)){for(k in j.rendererOptions){b={name:k,value:j.rendererOptions[k]};i.renderer.setOption(b.name,b.value)}}angular.forEach(j.callbacks,function(e){if(angular.isFunction(e)){e(i)}})};return{restrict:"EA",require:"?ngModel",link:function(b,t,q,u){var a=c.ace||{};var z=angular.extend({},a,b.$eval(q.uiAce));var r=window.ace.edit(t[0]);var s=r.getSession();var w;var v;var y=function(){var e=arguments[0];var f=Array.prototype.slice.call(arguments,1);if(angular.isDefined(e)){b.$evalAsync(function(){if(angular.isFunction(e)){e(f)}else{throw new Error("ui-ace use a function as callback.")}})}};var p={onChange:function(e){return function(f){var g=s.getValue();if(u&&g!==u.$viewValue&&!b.$$phase&&!b.$root.$$phase){b.$evalAsync(function(){u.$setViewValue(g)})}y(e,f,r)}},onBlur:function(e){return function(){y(e,r)}}};q.$observe("readonly",function(e){r.setReadOnly(!!e||e==="")});if(u){u.$formatters.push(function(e){if(angular.isUndefined(e)||e===null){return""}else{if(angular.isObject(e)||angular.isArray(e)){throw new Error("ui-ace cannot use an object or an array as a model")}}return e});u.$render=function(){s.setValue(u.$viewValue)}}var x=function(e,f){if(e===f){return}z=angular.extend({},a,b.$eval(q.uiAce));z.callbacks=[z.onLoad];if(z.onLoad!==a.onLoad){z.callbacks.unshift(a.onLoad)}s.removeListener("change",w);w=p.onChange(z.onChange);s.on("change",w);r.removeListener("blur",v);v=p.onBlur(z.onBlur);r.on("blur",v);d(r,s,z)};b.$watch(q.uiAce,x,true);x(a);t.on("$destroy",function(){r.session.$stopWorker();r.destroy()});b.$watch(function(){return[t[0].offsetWidth,t[0].offsetHeight]},function(){r.resize();r.renderer.updateFull()},true)}}}]);